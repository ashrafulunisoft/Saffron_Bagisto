Based on the **Phase 8 Comprehensive Implementation Guide** for Delivery Service Integration, here are the **Laravel migration tables** and **models** to align with the components and functionality described.

### 1. **Migration Table for Delivery Partners**

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateDeliveryPartnersTable extends Migration
{
    public function up()
    {
        Schema::create('delivery_partners', function (Blueprint $table) {
            $table->id();
            $table->enum('partner_name', ['pathao', 'uber_eats', 'shadhin']);
            $table->string('api_url');
            $table->string('api_key')->nullable();  // API keys for integration
            $table->string('auth_type')->default('api_key'); // Authentication type
            $table->boolean('is_active')->default(true);
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('delivery_partners');
    }
}
```

### 2. **Delivery Partner Model**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class DeliveryPartner extends Model
{
    use HasFactory;

    protected $fillable = [
        'partner_name',
        'api_url',
        'api_key',
        'auth_type',
        'is_active'
    ];

    /**
     * Get the API authentication details based on the partner.
     */
    public function getAuthDetailsAttribute()
    {
        return $this->auth_type === 'api_key' ? $this->api_key : null; // Additional logic can be added
    }

    /**
     * Get active partners for the system.
     */
    public function scopeActive($query)
    {
        return $query->where('is_active', true);
    }

    /**
     * Get all bookings associated with the delivery partner.
     */
    public function bookings()
    {
        return $this->hasMany(DeliveryBooking::class);
    }
}
```

---

### 3. **Migration Table for Delivery Bookings**

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateDeliveryBookingsTable extends Migration
{
    public function up()
    {
        Schema::create('delivery_bookings', function (Blueprint $table) {
            $table->id();
            $table->foreignId('order_id')->constrained()->onDelete('cascade');  // Link to the order
            $table->foreignId('delivery_partner_id')->constrained()->onDelete('cascade'); // Delivery partner relation
            $table->string('tracking_id')->nullable();  // Tracking ID from delivery partner
            $table->enum('status', ['pending', 'in_transit', 'delivered', 'failed']);
            $table->text('delivery_address');
            $table->decimal('delivery_fee', 8, 2);
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('delivery_bookings');
    }
}
```

### 4. **Delivery Booking Model**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class DeliveryBooking extends Model
{
    use HasFactory;

    protected $fillable = [
        'order_id',
        'delivery_partner_id',
        'tracking_id',
        'status',
        'delivery_address',
        'delivery_fee',
    ];

    /**
     * Get the delivery partner associated with the booking.
     */
    public function partner()
    {
        return $this->belongsTo(DeliveryPartner::class, 'delivery_partner_id');
    }

    /**
     * Get the associated order for this booking.
     */
    public function order()
    {
        return $this->belongsTo(Order::class);
    }

    /**
     * Get the status of the booking.
     */
    public function getStatusTextAttribute()
    {
        return ucfirst($this->status);
    }

    /**
     * Scope a query to include only completed deliveries.
     */
    public function scopeCompleted($query)
    {
        return $query->where('status', 'delivered');
    }
}
```

---

### 5. **Migration Table for Tracking Updates**

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateTrackingUpdatesTable extends Migration
{
    public function up()
    {
        Schema::create('tracking_updates', function (Blueprint $table) {
            $table->id();
            $table->foreignId('delivery_booking_id')->constrained()->onDelete('cascade');
            $table->string('location');
            $table->enum('status', ['in_transit', 'out_for_delivery', 'delivered', 'failed']);
            $table->timestamp('update_time');
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('tracking_updates');
    }
}
```

### 6. **Tracking Update Model**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class TrackingUpdate extends Model
{
    use HasFactory;

    protected $fillable = [
        'delivery_booking_id',
        'location',
        'status',
        'update_time',
    ];

    /**
     * Get the delivery booking associated with this tracking update.
     */
    public function booking()
    {
        return $this->belongsTo(DeliveryBooking::class, 'delivery_booking_id');
    }

    /**
     * Get the status text for the tracking update.
     */
    public function getStatusTextAttribute()
    {
        return ucfirst($this->status);
    }
}
```

---

### 7. **Migration Table for Address Validation**

```php
<?php

use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;
use Illuminate\Support\Facades\Schema;

class CreateAddressValidationsTable extends Migration
{
    public function up()
    {
        Schema::create('address_validations', function (Blueprint $table) {
            $table->id();
            $table->string('address');
            $table->enum('status', ['valid', 'invalid', 'pending']);
            $table->text('correction_suggestion')->nullable();
            $table->timestamps();
        });
    }

    public function down()
    {
        Schema::dropIfExists('address_validations');
    }
}
```

### 8. **Address Validation Model**

```php
<?php

namespace App\Models;

use Illuminate\Database\Eloquent\Factories\HasFactory;
use Illuminate\Database\Eloquent\Model;

class AddressValidation extends Model
{
    use HasFactory;

    protected $fillable = [
        'address',
        'status',
        'correction_suggestion',
    ];

    /**
     * Get the status text of the address validation.
     */
    public function getStatusTextAttribute()
    {
        return ucfirst($this->status);
    }

    /**
     * Scope a query to only include valid addresses.
     */
    public function scopeValid($query)
    {
        return $query->where('status', 'valid');
    }

    /**
     * Scope a query to include invalid addresses.
     */
    public function scopeInvalid($query)
    {
        return $query->where('status', 'invalid');
    }
}
```

---

These migration tables and models provide a robust foundation for managing delivery services, including **delivery partner integration**, **delivery booking management**, **real-time tracking**, and **address validation** within your platform. If you need further customization or additional tables, feel free to let me know!
